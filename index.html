<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Luau Obfuscator</title>
  <style>
    body { font-family: Arial, sans-serif; background: #1e1e1e; color: #fff; padding: 20px; }
    textarea { width: 100%; height: 200px; margin: 10px 0; background: #2b2b2b; color: #fff; border: none; padding: 10px; }
    button { padding: 10px 20px; background: #3a3a3a; color: #fff; border: none; cursor: pointer; }
    button:hover { background: #5a5a5a; }
  </style>
</head>
<body>
  <h1>Luau Obfuscator (Basic)</h1>
  <textarea id="inputCode" placeholder="Paste your Luau code here..."></textarea>
  <br>
  <button onclick="obfuscate()">Obfuscate</button>
  <button onclick="downloadFile()">Download</button>
  <textarea id="outputCode" placeholder="Obfuscated code will appear here..."></textarea>

  <script>
    function obfuscate() {
      let code = document.getElementById('inputCode').value;

      // Remove comments
      code = code.replace(/--\[\[[\s\S]*?\]\]/g, ''); // block comments
      code = code.replace(/--.*/g, ''); // single-line comments

      // Remove extra whitespace
      code = code.replace(/\s+/g, ' ');

      // Rename variables (very basic: replace 'local x' with 'local _v1')
      let counter = 0;
      let varMap = {};
      code = code.replace(/local\s+([a-zA-Z_][a-zA-Z0-9_]*)/g, function(_, name) {
        if (!varMap[name]) {
          counter++;
          varMap[name] = '_v' + counter;
        }
        return 'local ' + varMap[name];
      });

      // Encode strings
      function encodeString(str) {
        return str.split('').map(c => c.charCodeAt(0)).join(' ');
      }
      code = code.replace(/(["'])(.*?)\1/g, function(_, quote, content) {
        return `_S("${encodeString(content)}")`;
      });

      // Add decoder function
      let decoder = `local _S=function(s)local t={}for n in s:gmatch("%d+")do t[#t+1]=tonumber(n)end return string.char(table.unpack(t))end; `;
      code = decoder + code;

      document.getElementById('outputCode').value = code;
    }

    function downloadFile() {
      let content = document.getElementById('outputCode').value;
      let blob = new Blob([content], { type: "text/plain" });
      let link = document.createElement('a');
      link.href = URL.createObjectURL(blob);
      link.download = "obfuscated.lua";
      link.click();
    }
  </script>
</body>
</html>
